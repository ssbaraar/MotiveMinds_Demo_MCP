openapi: 3.0.3
info:
  title: MotiveMinds SAP Integration API
  description: |
    SAP Business Partner and Product Management API for Microsoft Copilot integration.
    Provides comprehensive SAP data access through optimized endpoints for customer search,
    product management, and generic SAP OData operations.
  version: 1.0.0
  contact:
    name: MotiveMinds Support
    url: https://motiveminds-demo-mcp.onrender.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: https://motiveminds-demo-mcp.onrender.com
    description: Production server

security:
  - ApiKeyAuth: []

paths:
  /mcp/tools/searchCustomerByCustomerDescription:
    post:
      operationId: searchCustomers
      summary: Search SAP Customers
      description: |
        Search for SAP customers by name or description using Business Partner API.
        Supports both exact match and substring search with configurable result limits.
      tags:
        - Customer Management
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - description
              properties:
                description:
                  type: string
                  description: Customer name or description to search for
                  example: "ACME Corporation"
                  minLength: 1
                  maxLength: 100
                search_field:
                  type: string
                  description: Field to search in
                  enum: ["CustomerName", "CustomerFullName", "Customer"]
                  default: "CustomerName"
                exact_match:
                  type: boolean
                  description: Whether to perform exact match or substring search
                  default: false
                max_results:
                  type: integer
                  description: Maximum number of results to return
                  minimum: 1
                  maximum: 100
                  default: 10
                base_url:
                  type: string
                  description: Optional custom base URL for SAP system
                  format: uri
      responses:
        '200':
          description: Customer search results
          content:
            application/json:
              schema:
                type: object
                properties:
                  search_query:
                    type: string
                    description: The search term used
                  search_field:
                    type: string
                    description: The field searched
                  exact_match:
                    type: boolean
                    description: Whether exact match was used
                  found_customers:
                    type: integer
                    description: Number of customers found
                  customers:
                    type: array
                    items:
                      type: object
                      properties:
                        Customer:
                          type: string
                          description: Customer ID
                        CustomerName:
                          type: string
                          description: Customer name
                        CustomerFullName:
                          type: string
                          description: Full customer name
              examples:
                success:
                  summary: Successful customer search
                  value:
                    search_query: "ACME"
                    search_field: "CustomerName"
                    exact_match: false
                    found_customers: 2
                    customers:
                      - Customer: "100001"
                        CustomerName: "ACME Corporation"
                        CustomerFullName: "ACME Corporation Ltd."
                      - Customer: "100002"
                        CustomerName: "ACME Industries"
                        CustomerFullName: "ACME Industries Inc."
        '400':
          description: Bad request - invalid parameters
        '500':
          description: Internal server error

  /mcp/tools/searchProductByDescription:
    post:
      operationId: searchProducts
      summary: Search SAP Products
      description: |
        Search for SAP products by description or retrieve specific product information.
        Supports both search mode and direct key lookup with multiple language options.
      tags:
        - Product Management
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                description:
                  type: string
                  description: Product description to search for (required for search mode)
                  example: "Laptop Computer"
                  maxLength: 200
                search_field:
                  type: string
                  description: Field to search in
                  enum: ["ProductDescription", "Product"]
                  default: "ProductDescription"
                language:
                  type: string
                  description: Language code for product descriptions
                  pattern: "^[A-Z]{2}$"
                  default: "EN"
                  example: "EN"
                exact_match:
                  type: boolean
                  description: Whether to perform exact match or contains search
                  default: false
                max_results:
                  type: integer
                  description: Maximum number of results to return
                  minimum: 1
                  maximum: 100
                  default: 10
                product:
                  type: string
                  description: Specific product ID for direct lookup
                  example: "LAPTOP001"
                key_mode:
                  type: string
                  description: Key lookup mode for direct product access
                  enum: ["auto", "segment", "paren"]
                  default: "auto"
                service_version:
                  type: string
                  description: SAP service version
                  pattern: "^\\d{4}$"
                  default: "0002"
                base_url:
                  type: string
                  description: Optional custom base URL for SAP system
                  format: uri
      responses:
        '200':
          description: Product search results
          content:
            application/json:
              schema:
                type: object
                properties:
                  mode:
                    type: string
                    description: Search mode used (search, key_segment, key_paren)
                  search_query:
                    type: string
                    description: The search term used (search mode only)
                  product_key:
                    type: string
                    description: Product key used (key mode only)
                  language:
                    type: string
                    description: Language code used
                  found_products:
                    type: integer
                    description: Number of products found
                  products:
                    type: array
                    items:
                      type: object
                      properties:
                        Product:
                          type: string
                          description: Product ID
                        ProductDescription:
                          type: string
                          description: Product description
                        Language:
                          type: string
                          description: Language code
              examples:
                search_success:
                  summary: Successful product search
                  value:
                    mode: "search"
                    search_query: "Laptop"
                    language: "EN"
                    found_products: 1
                    products:
                      - Product: "LAPTOP001"
                        ProductDescription: "High-performance Laptop Computer"
                        Language: "EN"
        '400':
          description: Bad request - invalid parameters
        '500':
          description: Internal server error

  /mcp/tools/generic_sap_search:
    post:
      operationId: genericSapSearch
      summary: Generic SAP OData Query
      description: |
        Execute generic SAP OData queries with full flexibility for custom operations.
        Supports both OData v2 and v4 with configurable HTTP methods and parameters.
      tags:
        - SAP Integration
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - service_path
              properties:
                service_path:
                  type: string
                  description: SAP service path (without host/client)
                  example: "sap/opu/odata/sap/API_SALES_ORDER_SRV/A_SalesOrder"
                  minLength: 1
                method:
                  type: string
                  description: HTTP method to use
                  enum: ["GET", "POST", "PUT", "PATCH", "DELETE"]
                  default: "GET"
                headers:
                  type: object
                  description: Additional HTTP headers
                  additionalProperties:
                    type: string
                  example:
                    "X-Custom-Header": "value"
                params:
                  type: object
                  description: Query parameters for OData operations
                  additionalProperties:
                    type: string
                  example:
                    "$filter": "SalesOrder eq '1000000001'"
                    "$select": "SalesOrder,SalesOrderType,SoldToParty"
                    "$top": "10"
                data:
                  type: string
                  description: Request body data (for POST/PUT operations)
                  example: '{"SalesOrderType": "OR", "SoldToParty": "100001"}'
      responses:
        '200':
          description: SAP OData response
          content:
            application/json:
              schema:
                type: object
                description: Raw SAP OData response
              examples:
                odata_v2:
                  summary: OData v2 response
                  value:
                    d:
                      results:
                        - SalesOrder: "1000000001"
                          SalesOrderType: "OR"
                          SoldToParty: "100001"
        '400':
          description: Bad request - invalid service path or parameters
        '500':
          description: SAP system error or connection failure

  /mcp/tools/post_to_sap:
    post:
      operationId: postToSap
      summary: POST Data to SAP
      description: |
        Send POST requests to SAP endpoints for creating or updating data.
        Supports custom headers and content types with comprehensive error handling.
      tags:
        - SAP Integration
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - endpoint
                - payload
              properties:
                endpoint:
                  type: string
                  description: SAP endpoint URL or path
                  example: "API_SALES_ORDER_SRV/A_SalesOrder"
                  minLength: 1
                payload:
                  type: string
                  description: JSON payload to send
                  example: '{"SalesOrderType": "OR", "SoldToParty": "100001", "RequestedDeliveryDate": "2024-12-31"}'
                content_type:
                  type: string
                  description: Content-Type header
                  default: "application/json"
                  example: "application/json"
                additional_headers:
                  type: object
                  description: Additional HTTP headers
                  additionalProperties:
                    type: string
                  example:
                    "X-CSRF-Token": "fetch"
                    "X-Requested-With": "XMLHttpRequest"
      responses:
        '200':
          description: POST operation result
          content:
            application/json:
              schema:
                type: object
                properties:
                  status_code:
                    type: integer
                    description: HTTP status code from SAP
                  status_message:
                    type: string
                    description: Status message
                  response_data:
                    type: string
                    description: Response data from SAP
                  url:
                    type: string
                    description: Actual URL called
              examples:
                success:
                  summary: Successful POST operation
                  value:
                    status_code: 201
                    status_message: "Success"
                    response_data: '{"d": {"SalesOrder": "1000000123"}}'
                    url: "https://sap.example.com/sap/opu/odata/sap/API_SALES_ORDER_SRV/A_SalesOrder"
                error:
                  summary: Failed POST operation
                  value:
                    status_code: 400
                    status_message: "HTTP Error: Bad Request"
                    error_details: "Invalid field value"
                    url: "https://sap.example.com/sap/opu/odata/sap/API_SALES_ORDER_SRV/A_SalesOrder"
        '400':
          description: Bad request - invalid endpoint or payload
        '500':
          description: SAP system error or connection failure

  /mcp/resources/greeting:
    get:
      operationId: getGreeting
      summary: Get Personalized Greeting
      description: Generate a personalized greeting message
      tags:
        - Utilities
      parameters:
        - name: name
          in: query
          required: true
          schema:
            type: string
            example: "John Doe"
          description: Name for personalized greeting
      responses:
        '200':
          description: Personalized greeting
          content:
            text/plain:
              schema:
                type: string
                example: "Hello, John Doe!"

components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key
      description: API key for authentication

  schemas:
    ErrorResponse:
      type: object
      properties:
        error:
          type: string
          description: Error message
        details:
          type: string
          description: Detailed error information
      required:
        - error

tags:
  - name: Customer Management
    description: SAP customer search and management operations
  - name: Product Management
    description: SAP product search and information retrieval
  - name: SAP Integration
    description: Generic SAP OData operations and data manipulation
  - name: Utilities
    description: Helper functions and utilities

externalDocs:
  description: MotiveMinds SAP Integration Documentation
  url: https://motiveminds-demo-mcp.onrender.com/docs